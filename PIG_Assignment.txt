Assignment #3 Pig Programming
Dataset: twitter full_text.txt 

Questions:

1) Find hour of the day when highest number of tweets were generated by users on March 6, 2010

2) Find top 10 topics (#hashtags)


3) Find top 10 mentions (@xxxxxxx)b 

Submission:
Pig Latin scripts uploaded in pdf or text file
Output of each query


1) Ans:
a = load '/user/pig/full_text.txt' as (id:chararray, ts:chararray, location:chararray, lat:float, lon:float, tweet:chararray);
b = foreach a generate id, ts, SUBSTRING(ts, 0, 10) as ts1, GetHour(ToDate(ts)) as ts2, tweet;
c = filter b by ts1 == '2010-03-06';
c1 = limit c 5;
dump c1;
d = group c by ts2;
e = foreach d generate COUNT(c);
f = dump e; 

Result: 01 hour, No. of tweets: 3913


2)Ans:
a = load '/user/pig/full_text.txt' as (id:chararray, ts:chararray, location:chararray, lat:float, lon:float, tweet:chararray);
b1 = foreach a generate FLATTEN(TOKENIZE(tweet)) as token;
c1 = filter b1 by STARTSWITH(token, #);
cc = limit c1 10;
dump cc;
d1 = group c1 all;
e1 = foreach d1 generate group as id, COUNT(c1) as cnt;
f1 = order e1 by cnt desc;
g1 = limit f1 10;
dump g1;


3) Ans:
a = load '/user/pig/full_text.txt' as (id:chararray, ts:chararray, location:chararray, lat:float, lon:float, tweet:chararray);
b2 = foreach a generate id, tweet;
c2 = filter b2 by tweet MATCHES '.*@USER_\\S{8}.*';
d2 = group c2 by '.*@USER_\\S{8}.*';
e2 = foreach d2 generate group as id, COUNT(c2) as cnt;
f2 = order e2 by cnt desc;
g2 = limit f2 10;
dump g2;

 








 

 
